<launch>
    <arg name="model" default="$(env TURTLEBOT3_MODEL)" doc="model type [burger, waffle, waffle_pi]"/>
    <arg name="move_forward_only" default="false"/>

    <!-- mapping node initialised -->
    <node pkg="gmapping" type="slam_gmapping" name="slam_gmapping" required="true" args="odom_frame:= odom2">
        <param name="linearUpdate" value="0.15"/>
    </node>

    <!-- to save map to a file -->
    <arg name="map_folder" default="map"/>
    <node name="map_saver" pkg="map_server" type="map_saver" args="static_map:=dynamic_map -f $(find com2009_team61)/launch/maps/map">
        <remap from="/map" to="$(arg map_folder)"/>
    </node>

    <!-- init arguments -->
    <arg name="map_file" default="$(find com2009_team61)/launch/maps/map.yaml"/>
    <arg name="initial_pose_x" default="0.0"/>
    <arg name="initial_pose_y" default="0.0"/>
    <arg name="initial_pose_a" default="0.0"/>

    <!-- Turtlebot3 Bringup -->
    <include file="$(find turtlebot3_bringup)/launch/turtlebot3_remote.launch">
        <arg name="model" value="$(arg model)" />
    </include>

    <!-- <node name="map_server" pkg="map_server" type="map_server" args="$(arg map_file)"/> -->

    <!-- <include file="$(find turtlebot3_navigation)/launch/amcl.launch">
        <arg name="initial_pose_x" value="$(arg initial_pose_x)"/>
        <arg name="initial_pose_y" value="$(arg initial_pose_y)"/>
        <arg name="initial_pose_a" value="$(arg initial_pose_a)"/>
    </include> -->

    <include file="$(find turtlebot3_navigation)/launch/move_base.launch">
        <param name="local_costmap/obstacle_layer/inflation_radius" value="0.02" />
        <param name="global_costmap/obstacle_layer/inflation_radius" value="0.02" />
        <param name="local_costmap/obstacle_layer/cost_scaling_factor" value="1.0" />
        <param name="global_costmap/obstacle_layer/cost_scaling_factor" value="1.0" />
        <arg name="model" value="$(arg model)" />
        <arg name="move_forward_only" value="$(arg move_forward_only)"/>
    </include>

    <!-- rviz -->
    <node pkg="rviz" type="rviz" name="rviz" required="true"
        args="-d $(find turtlebot3_navigation)/rviz/turtlebot3_navigation.rviz"/>

    <node pkg = "com2009_team61" type = "task4test.py" name = "t4_node" output = "screen">
    </node>
</launch>